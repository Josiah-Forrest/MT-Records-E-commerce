(function(e){var c=window.AmazonUIPageJS||window.P,h=c._namespace||c.attributeErrors,a=h?h("StarlingInterestGroupAssignment",""):c;a.guardFatal?a.guardFatal(e)(a,window):a.execute(function(){e(a,window)})})(function(e,c,h){e.register("StarlingIGJoinConfiguration",function(){return{getRoboticSessionId:function(){return"000-0000000-0000000"},getSecondsPerDay:function(){return 86400},getToken:function(a){switch(a){case "gamma":return"Ay3WBRr5OtmyD3mwpIWyox6nl2xsEL3JyighG4NpbfO3kyka10dzD97eJA+ekMnq3XLi8hPC8gpBGSClwt5wEgYAAACaeyJvcmlnaW4iOiJodHRwczovL2F0LWdhbW1hLXVzLWVhc3QuYW1hem9uLWFkc3lzdGVtLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjY5NzY2Mzk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ\x3d\x3d";
case "prod":return"A7jDbyz2LmRMzv5b5laRj897GzAsLHZaNDTnlB+0XsNiHLfX8/4RcCUioP/IY9mxlewyosoNcmkbGyxc62ag1gcAAACEeyJvcmlnaW4iOiJodHRwczovL3d3dy5hbWF6b24uY29tOjQ0MyIsImZlYXR1cmUiOiJQcml2YWN5U2FuZGJveEFkc0FQSXMiLCJleHBpcnkiOjE2ODA2NTI3OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"}},getUserAgent:function(){return navigator.userAgent}}});"use strict";e.register("StarlingAddMetric",function(){return{addMetric:function(a,b){c.ue&&c.ue.count&&c.ue.count(a,b)}}});"use strict";e.register("StarlingLogError",
function(){return{logError:function(a){var b={logLevel:2<arguments.length&&arguments[2]!==h?arguments[2]:"ERROR",attribution:"StarlingInterestGroupAssignment",message:1<arguments.length&&arguments[1]!==h?arguments[1]:""};c.ueLogError&&c.ueLogError(a,b);return[a,b]}}});"use strict";e.when("StarlingIGJoinConfiguration","StarlingAddMetric","StarlingLogError","a-util").register("StarlingIGJoinHelpers",function(a,b,d,f){function e(){return c.opts.customerId}function t(a){switch(a){case "beta":return"https://at-"+
a+".amazon-adsystem.com";case "gamma":return"https://at-"+a+"-us-east.amazon-adsystem.com";case "prod":return"https://at-us-east.amazon-adsystem.com"}}function l(a){if(a){if((a=a.interestGroups)&&Array.isArray(a)&&0<a.length)return b.addMetric("Starling:AttemptedIGAdd",a.length),a;b.addMetric("Starling:GatewayReturnedIGMetadata:False",1);a={message:"Starling:GatewayReturnedIGMetadata:False. IG Metadata from Gateway is empty or incorrect format."};d.logError(a);return null}b.addMetric("Starling:NullGatewayResponseError",
1);a={message:"Starling:NullGatewayResponseError. Null IGMetadata response from Gateway."};d.logError(a)}function n(a,b){return new Promise(function(k,g){try{navigator.joinAdInterestGroup(a,30*b),k()}catch(m){g(m)}})}function p(a,b){var k=[],g=!0,d=!1,c=h;try{for(var f=a[Symbol.iterator](),e;!(g=(e=f.next()).done);g=!0)k.push(n(e.value,b))}catch(w){d=!0,c=w}finally{try{!g&&f.return&&f.return()}finally{if(d)throw c;}}return k}function q(a,g){var k=0,c=0;a=p(a,g);Promise.allSettled(a).then(function(a){var g=
!0,d=!1,f=h;try{for(var m=a[Symbol.iterator](),r;!(g=(r=m.next()).done);g=!0)"fulfilled"===r.value.status?k+=1:c+=1}catch(x){d=!0,f=x}finally{try{!g&&m.return&&m.return()}finally{if(d)throw f;}}b.addMetric("Starling:BrowserAddedToIG:True",k);b.addMetric("Starling:BrowserAddedToIG:False",c);e()?b.addMetric("Starling:IGAssigned:AmazonCustomer",k):b.addMetric("Starling:IGAssigned:AmazonGuest",k)}).catch(function(a){b.addMetric("Starling:PromiseResolverError",1);d.logError(a,"Starling:PromiseResolveError. Error resolving IGJoinPromiseArray.")})}
function u(a){return c.localStorage.getItem(a)}function v(a,b){a=String(a);b=String(b);c.localStorage.setItem(a,b)}var y=/development|beta/,z=/pre-prod|gamma/,A=/chrome|chromium|crios/i,B=/opr\//i,C=/edg/i;return{isChrome:function(){var b=a.getUserAgent(),d=!1;b&&(b.match(A)&&(d=!0),b.match(B)?d=!1:b.match(C)&&(d=!1));return d},browserSupportsAdInterestGroup:function(){return"joinAdInterestGroup"in navigator&&document.featurePolicy.allowsFeature("join-ad-interest-group")},getWindowOpts:function(){return c.opts},
getHref:function(){return c.location.href},getCustomerId:e,getApnPrivacySetting:function(){if(null!==document&&null!==document.cookie){var a=document.cookie.match(/(^| )apn-privacy=([^;]+)/);if(a)return"true"===a[2]}return!1},getStage:function(a){return y.test(a)?"beta":z.test(a)?"gamma":"prod"},generateGatewayUrl:t,provideToken:function(a){if(null!==document&&null!==document.head){var b=document.createElement("meta");b.httpEquiv="origin-trial";b.content=a;document.head.appendChild(b)}},parseIGMetadataFromResponse:l,
createIGJoinPromise:n,createIGJoinPromiseArray:p,settleIGJoinPromises:q,joinAdInterestGroups:function(c,f){var e=a.getSecondsPerDay();f=t(f)+"/interestGroups/join/";var k=u("timestampForNextRequest"),g=k?Number(k):0;0==g||g<(new Date).getTime()?fetch(f,{method:"PUT",body:JSON.stringify(c)}).then(function(a){b.addMetric("Starling:ReceivedGatewayResponse",1);return a.json()}).then(function(a){var b=JSON.parse(JSON.stringify(a));a=l(b);if(b=b.throttleTimeForNextRequest)g=0==b?0:Number(b)+(new Date).getTime(),
v("timestampForNextRequest",g);a&&q(a,e)}).catch(function(a){b.addMetric("Starling:ParseGatewayResponseError",1);d.logError(a,"Starling:ParseGatewayResponseError. Error parsing IG Metadata from Gateway.")}):b.addMetric("Starling:ThrottledIGJoinRequests",1)},lookupLocalStorage:u,addToLocalStorage:v,removeFromLocalStorage:function(a){c.localStorage.getItem(a)!==h&&c.localStorage.removeItem(a)},getCookieValue:function(a){return f.cookies.get(a)}}});"use strict";e.register("StarlingInterestGroupAssign",
function(){var a={init:function(b,d,f,c){a.config=b;a.helpers=c;a.metrics=d;a.errors=f;b=a.config.getRoboticSessionId();d=a.helpers.getHref();a.helpers.isChrome()&&(d?(d=a.helpers.getStage(d),f=a.config.getToken(d),a.helpers.provideToken(f),a.assignIG(d,b)):(a.metrics.addMetric("Starling:PageLoadError",1),a.errors.logError({message:"Starling:PageLoadError. Error retreiving url from window."})))},assignIG:function(b,d){if(a.helpers.browserSupportsAdInterestGroup()){a.metrics.addMetric("Starling:BrowserSupportsAdInterestGroup:True",
1);var c=a.helpers.getWindowOpts();if(c){var e=c.sessionId,h=c.pageType;c=c.asin;var l=a.helpers.getApnPrivacySetting(),n=a.helpers.getHref;d=e===d;var p=a.helpers.getCookieValue("ad-id"),q=a.helpers.getCustomerId();l||d?a.metrics.addMetric("Starling:TotalPunts",1):a.helpers.joinAdInterestGroups({identity:{customerId:q,sessionId:e,adId:p},pageInformation:{pageURL:n,pageType:h,asins:[c]}},b);l&&a.metrics.addMetric("Starling:UserOptedOut:True",1);d&&a.metrics.addMetric("Starling:RoboticTraffic:True",
1);a.helpers.getCustomerId()?a.metrics.addMetric("Starling:BrowserSupportsAdInterestGroup:AmazonCustomer",1):a.metrics.addMetric("Starling:BrowserSupportsAdInterestGroup:AmazonGuest",1)}else a.metrics.addMetric("Starling:OptsNotFoundError",1),a.errors.logError({message:"Starling:OptsNotFoundError. Error getting windowOpts."})}else a.metrics.addMetric("Starling:BrowserSupportsAdInterestGroup:False",1)}};return a});e.when("StarlingIGJoinConfiguration","StarlingAddMetric","StarlingLogError","StarlingIGJoinHelpers",
"StarlingInterestGroupAssign","ready").execute(function(a,b,c,e,h){h.init(a,b,c,e)})});